# Exemplo de Sealed Secret para certificados ICP-Brasil
# Este arquivo deve ser criptografado com kubeseal antes do deploy

# Para criar um sealed secret:
# 1. Criar secret normal:
#    kubectl create secret generic icp-certificates \
#      --from-file=icp-brasil-receita-prod.pem=certs/icp-brasil-receita-prod.pem \
#      --from-file=icp-brasil-receita-prod.key=certs/icp-brasil-receita-prod.key \
#      --namespace=data \
#      --dry-run=client -o yaml > /tmp/secret.yaml
#
# 2. Criptografar com kubeseal:
#    kubeseal --format yaml < /tmp/secret.yaml > k8s/integration-gateway/sealed-secret-icp-certs.yaml
#
# 3. Aplicar sealed secret:
#    kubectl apply -f k8s/integration-gateway/sealed-secret-icp-certs.yaml
#
# 4. Deletar arquivo temporário:
#    rm /tmp/secret.yaml

---
# Placeholder - substituir pelo sealed secret real
apiVersion: v1
kind: Secret
metadata:
  name: icp-certificates
  namespace: data
type: Opaque
stringData:
  # NUNCA commitar certificados reais aqui!
  # Este é apenas um exemplo de estrutura
  # Use kubeseal para criar sealed secrets

  # Exemplo de estrutura (após kubeseal):
  # icp-brasil-receita-prod.pem: <base64-encoded-cert>
  # icp-brasil-receita-prod.key: <base64-encoded-key>

  README.md: |
    Este secret contém certificados ICP-Brasil para autenticação com APIs governamentais.

    Certificados disponíveis:
    - icp-brasil-receita-prod.pem/.key - Receita Federal (Produção)
    - icp-brasil-receita-sandbox.pem/.key - Receita Federal (Sandbox)

    Para adicionar novos certificados, use kubeseal:
    kubectl create secret generic icp-certificates \
      --from-file=cert.pem=path/to/cert.pem \
      --from-file=cert.key=path/to/cert.key \
      --namespace=data \
      --dry-run=client -o yaml | kubeseal --format yaml > sealed-secret.yaml
