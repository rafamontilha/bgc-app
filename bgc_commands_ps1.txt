# BGC Analytics - Script de comandos principais
# Uso: .\bgc.ps1 <comando>
# Exemplo: .\bgc.ps1 setup

param(
    [Parameter(Position=0)]
    [string]$Command = "help",
    [string]$Namespace = "default",
    [string]$ClusterName = "bgc"
)

$ApiImage = "bgc/api:dev"
$IngestImage = "bgc/ingest:dev"

function Show-Help {
    Write-Host "BGC Analytics - Comandos dispon√≠veis:" -ForegroundColor Green
    Write-Host ""
    Write-Host "üöÄ Setup e Deploy:" -ForegroundColor Yellow
    Write-Host "  setup        - Configura ambiente completo (cluster + postgres)"
    Write-Host "  build        - Faz build de todas as imagens"
    Write-Host "  import       - Importa imagens no k3d"
    Write-Host "  deploy       - Deploy completo (API + ingest)"
    Write-Host "  dev          - Pipeline completo (build + import + deploy)"
    Write-Host ""
    Write-Host "üìä Monitoramento:" -ForegroundColor Yellow
    Write-Host "  status       - Mostra status dos pods e servi√ßos"
    Write-Host "  logs-api     - Mostra logs da API"
    Write-Host "  logs-ingest  - Mostra logs do √∫ltimo job de ingest"
    Write-Host "  test         - Testa conectividade da API"
    Write-Host ""
    Write-Host "üîß Opera√ß√£o:" -ForegroundColor Yellow
    Write-Host "  port-forward - Inicia port-forward da API (porta 3000)"
    Write-Host "  psql         - Acessa PostgreSQL via cliente"
    Write-Host "  load-sample  - Carrega dados de exemplo"
    Write-Host "  refresh-mv   - Atualiza Materialized Views"
    Write-Host ""
    Write-Host "üõ†Ô∏è Manuten√ß√£o:" -ForegroundColor Yellow
    Write-Host "  reboot-fix   - Corrige problemas p√≥s-reboot"
    Write-Host "  clean-jobs   - Remove jobs antigos"
    Write-Host "  clean        - Remove cluster completamente (CUIDADO!)"
    Write-Host ""
    Write-Host "Exemplo de uso: .\bgc.ps1 setup" -ForegroundColor Cyan
}

function Invoke-Setup {
    Write-Host "üöÄ 